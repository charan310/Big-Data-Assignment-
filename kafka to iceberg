2.Connect Kafka data to Iceberg table using Python
from pyspark.sql import SparkSession

# Initialize SparkSession
spark = SparkSession.builder \
    .appName("KafkaToIceberg") \
    .getOrCreate()

# Read data from Kafka
data = spark \
    .readStream \
    .format("kafka") \
    .option("kafka.bootstrap.servers", "localhost:9092") \
    .option("subscribe", "kevent") \
    .load()

# Write data to Iceberg table
data.write \
    .format("iceberg") \
    .mode("append") \
    .save("mnt/d/output/iceberg_table")
